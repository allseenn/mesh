# Распределенные системы и сети

## Урок 3. Примеры распределённых технологий

### Домашнее задание

Развертывание системы проксирования через NGINX, согласно занятию.

Предоставление реквизитов доступа в виде доменных имен к сервисам Grafana, InfluxDB, Node-Red каждым студентом.

(Например: grafana-gvi.gb-iot-1234.ru, influxdb-gvi.gb-iot-1234.ru, nodered-gvi.gb-iot-1234.ru).

## Решение

### Учетные данные

Ко всем службам используются одни учетные данные:

- логин: admin
- пароль: students

### Список сервисов и их адресов

1. **Mosquitto:** wss://mosquitto-rrg-5471.gb-iot.ru
2. **IndluxDB2:** https://influxdb-rrg-5471.gb-iot.
3. **NodeRed:** https://nodered-rrg-5471.gb-iot.ru
   ru
4. **Grafana:** https://grafana-rrg-5471.gb-iot.ru

#### 1. Mosquitto

В качестве клиента рекомендую [MQTTX](https://mqttx.app/downloads), т.к. стандартный консольный клиент не умеет работать с вебсокетом, который еще и обернут в TLS от nginx.

В схеме обратного прокси с поддоменами, достаточно одного открытого порта на шлюзе 443 для nginx, в отличие от схемы с подпапками, где пришлось отрывать дополнительный порт под вебсокет.

В MQTTX через кнопку (+) плюс создаем новое соединение с шифрованным вебсокетом wss:

<img src=pics/01.png>

Нажав кнопку Connect соединяемся через nginx с Mosquitto. Таким образом мы можем регулировать работу оконечного оборудования.

Предположим мы имеем, несколько метеостанций в различных районах и информация поступает по защищенному протоколу на наш сервер по сети интернет. Внизу программы с помощью окошка отправки сообщения в заголовке напечатаем MeteoStationKremlin - это так topic, и выбрав формат сообщения PlainText в теле сообщения отправим температуру -15.5

